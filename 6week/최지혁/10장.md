# 문제 이해 및 설계 범위 확정
어떤 종류의 알람을 지원해야 하는가 
- 푸시알림 SMS메시지 그리고 이메일
실시간 시스템이어야 하는가?
- 연성 실시간 시스템이라 가정 빠를 수록 좋으나 높은 부하가 걸릴경우 약간의 지연은 무방
어떤 종류의 단말을 지원?
- 안드로이드, ios. 랩톱/데스크탑
알림은 누가 만드는가?
- 클라이언트 앱 프로그램 및 서버측 스케줄링
사용자가 수신 거부 설정 가능?
- 가능
하루에 몇건의 알림?
- 천만건 모바일, 백만건 SMS 5백만건 이메일

# 개략적인 설계안 제시 및 동의 구하기
## 알림 유형별 지원 방안
알림 유형에 따라 지원하는 서비스가 다르다. 각 유형를 한 시스템으로 묶으면 다음과 같다.
![](https://lh4.googleusercontent.com/fnXs8I4JKLKJ5_6q9kVQBATYvFqQPD5P7X__iRrEWByd2exwhhSt6n3EHlpukjDo3NWH6g_X1A7gfB41lOlJqexHC5E_Swt-xJoLmO8s9yHy4BaVtmmDnf_XPyRbz64YPZy_4n7IWEWfKSaz1xqdEGk)

## 연락처 정보 수집 절차
알림을 보내려면 모바일 단말 토큰, 전화 번호 이메일 주소등이 필요하다.
사용자가 앱을 설치하거나 처음으로 계정을 등록하면 API 서버는 해당 사용자의 정보를 수집하여 데이터베이스에 저장한다.

## 알림 전송 및 수집 절차
### 개략적 설계안
![](https://user-images.githubusercontent.com/42582516/187309950-c1fe0b13-5501-45d1-83bb-9678e224f750.png)
위 시스템 문제
- SPOF 존재
- 규모 확장성 문제 서비스가 한 대라 DB나 캐시 등 개별증설 불가 
- 성능 병목: 서버가 한대면 사용자 트래픽이 많이 몰릴때 과부하 상태에 빠짐

### 개선된 버전(초기 버전)
![](https://user-images.githubusercontent.com/42582516/187311229-31aac627-e44a-4cb6-b466-fe67f31e4507.png)
- 데이터베이스와 캐시를 알림 시스템의 주 서버에서 분리
- 알림 서버를 증설 하고 수평적 규모 확장이 이루어질 수 있도록 수정
- 메시지 큐를 이용하여 시스템 컴포넌트 사이의 강한 결합 제거

알림서버
- 알림 전송 API
- 알림 검증
- 데이터베이스 또는 캐시 질의
- 알림 전송
캐시
DB
메시지 큐
작업서버
# 상세설계
### 안정성
- 데이터 손실 방지
- 알림 중복 전송 방지
### 추가로 필요한 컴포넌트 및 고려사항
- 알림 템플릿
- 알림 설정
- 전송률 제한
- 재시도 방법
- 푸쉬 알림과 보안
- 큐 모니터링(큐에 쌓인 알림의 개수를 모니터링 하여 서버 증설)
- 이벤트 추적
### 수정된 설계안
![](https://user-images.githubusercontent.com/42582516/187312387-4041f53c-ffcb-41bf-8da1-a7bb89342298.png)

# 마무리
- 개략적 설계안과 더불어 각 컴포넌트의 구현 방법과 최적화 기법에 집중했으며, 아래의 주제에 대해 이야기했습니다.
    - 안정성
    - 보안
    - 이벤트 추적 및 모니터링사용자 설정
    - 전송률 제한